<!DOCTYPE html>
<html lang="es">

<head>
    <meta http-equiv="content-type" content="text/html" charset="utf-8">
    <!-- css -->
    <link rel="stylesheet" href="css/lib/reset.css" type="text/css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="css/lib/jquery-ui-1.9.1.custom.min.css" type="text/css" media="screen">
    <link rel="stylesheet" href="css/lib/kendo.common.min.css" type="text/css" media="screen">
    <link rel="stylesheet" href="css/lib/kendo.metro.min.css" type="text/css" media="screen">
    <link rel="stylesheet" href="css/layout.css" type="text/css" media="screen">
    <link rel="stylesheet" href="css/lib/jquery.confirm.css" type="text/css" media="screen">
    <!-- javascript libs-->
    <script type="text/javascript" src="js/lib/jquery-1.8.2.js"></script>
    <script type="text/javascript" src="js/lib/jquery-ui-1.9.1.custom.min.js"></script>
    <script type="text/javascript" src="js/lib/jquery.pajinate.js"></script>
    <script type="text/javascript" src="js/lib/kendo.web.min.js"></script>
    <script type="text/javascript" src="js/lib/underscore.js"></script>
    <script type="text/javascript" src="js/lib/knockout-2.1.0.js"></script>
    <script type="text/javascript" src="js/lib/knockout.mapping.js"></script>
    <script type="text/javascript" src="js/lib/sammy-latest.min.js" ></script>
    <script type="text/javascript" src="js/lib/knockout-kendo.min.js"></script>
    <script type="text/javascript" src="js/lib/jquery.confirm.js"></script>
    <!-- javascript custom-->
    <script type="text/javascript" src="js/dictionary.js" ></script>
    <script type="text/javascript" src="js/dragDrop.js"></script>
    <script type="text/javascript" src="js/pagination.js"></script>
    <script type="text/javascript" src="js/tooltips.js"></script>
    <script type="text/javascript" src="js/filters.js"></script>
    <script type="text/javascript" src="js/modal.js"></script>
    <script type="text/javascript" src="js/mvvm.js"></script>

    <link rel="icon" href="images/favicon.ico" type="image/x-icon"> 
    
	<title>Episteme</title>

</head>

<body>
    <div id="container">
        <div id="header">
	    <div id = "logo">
		<a href="#/main">
                <img class="epistemeLogo" src="images/episteme_logo.png"/>
                </a>
		<br class="clear" />
            </div>

	    <div  id = "menuBar" data-bind="visible: page() < 3">
	        <div  class = "menuBarItem" data-bind="css: { selected: page() == 0 }">
		  <a href="#/main">
		  <div class = "menuItemIcon ">
                    <img src="images/opportunity.svg" />
		  </div>
		  <div class = "menuItemText "><span data-bind="text: lang().m1"></span></div>
		  <div class = "menuItemArrow"></div>
		  </a>
		</div>
		<div  class = "menuBarItem" data-bind="css: { inactive: status() < 1, selected: page() == 1 }">
		  <a data-bind="attr: {'href': '#/composer' + '/' + selectedOffer()}">
		  <div class = "menuItemIcon ">
                    <img src="images/company.svg" />
		  </div>
		  <div class = "menuItemText"><span data-bind="text: lang().m2"></span></div>
		  </a>
		</div>
		<div  class = "menuBarItem" data-bind="css: { inactive: status() < 2,  selected: page() == 2 }">
		  <a href="#/finalize">
		  <div class = "menuItemIcon ">
                    <img src="images/finalize.svg" />
		  </div>
		  <div class = "menuItemText"><span data-bind="text: lang().m3"></span></div>
		  </a>
		</div>
		<div  class = "menuBarItem" data-bind="css: { inactive: status() < -1, selected: help()}">
		  <a  href="#" data-bind="click: $root.activateHelp.bind($data,'help','')">
		  <div class = "menuItemIcon ">
                    <img src="images/help.svg" />
		  </div>
		  <div class = "menuItemText"><span data-bind="text: lang().m5"></span></div>
		  </a>
		</div>
		<div  class = "selectedOffer" data-bind="visible: page() > 0, click: $root.activateHelp.bind($data,'offer',selectedOffer()), clickBubble: false">
		</div><span data-bind="visible: loading()">Loading...</span>
	    </div>
	    <div  id = "langBar" >
	        <a href="#" data-bind="click: changeLanguage.bind($data,'0')">
			<img class="flag" src="images/spanish.png" data-bind="css: { flagSelected: lang().lang == 'Spanish' }"/>		
		</a>
	        <a href="#" data-bind="click: changeLanguage.bind($data,'1')">
			<img class="flag" src="images/english.png" data-bind="css: { flagSelected: lang().lang == 'English' }"/>
		</a>
	    </div>
	    <div  id = "messageBar" >
		<!-- ko if: filteredData().length != 1 -->
		<div id = "mBarText" data-bind="text: filteredData().length + ' ' + lang().m4, visible: page() == 1" ></div>
		<!-- /ko -->
		<!-- ko if: filteredData().length == 1 -->
		<div id = "mBarText" data-bind="text: filteredData().length + ' ' + lang().m4b, visible: page() == 1" ></div>
		<!-- /ko -->
	    </div>
        </div>
<div id="main" class="mainContainer" data-bind="visible: page() < 3">
<!-- KENDO FILTERS -->
<ul class="filterPanel" data-bind="kendoPanelBar: {}, foreach: loadedCategories">
    <li>
        <span class="filterName" data-bind="text: $parent.lang()[name()]"></span><span class="separator"></span>
        <ul class="filterGroup" data-bind="foreach: values">
            <li class="k-item k-state-default">
                <a class="filter k-link" href="#" data-bind="text: name,
                click: $root.selection.bind($data, $parent.id(), id, name()),
                css: { active: state() == true}"></a>
            </li>
        </ul>
    </li>
</ul>

<!-- DROPPABLES -->
<div class="dropContainer" data-bind="css: { offerContainer: page() == 0 }" >
    <!-- COMPOSER -->
    <div id="droppableElements" data-bind="visible: page() == 1" >

        <div data-bind="foreach: $root.offerReq">
	 <div  class="droppable droppableCompany company" class="class2" data-bind="visible: $root.page() > 0, attr: {'name': $data}">
            <div class="draggableInfo droppableInfo" data-bind="attr: {'title': '<table><tbody>' + $root.nestedReqSkills()[$index()] + '</tbody></table>'}">?</div>
   	    <div class ="droppableText"> <span data-bind="text: $root.lang().d2"></span> </div>
	 </div>
	</div>
        
        <div class="lines" id="lines" data-bind="if: page() == 1">
		<img class="img" data-bind="attr: { 'src': lang().i1 }">
	</div>
        <!-- ko if: semanticOrder() == false -->
	<div class="lines" id="Clicklines" data-bind="if: page() == 1">
		<img class="img" data-bind="attr: { 'src': lang().i4 }">
	</div>
        <!-- /ko -->
	<!-- ko if: semanticOrder() == true -->
	<div class="lines" id="Clicklines" data-bind="if: page() == 1">
		<img class="img" data-bind="attr: { 'src': lang().i5 }">
	</div>
        <!-- /ko -->
    </div>
    <!-- FINALIZE -->
    <div id="finalizeElements" data-bind="visible: page() == 2" >
       <div id="finalizeContainer" class="finalizeContainer" data-bind="visible: page() == 2">

          <h2> <span data-bind="text: lang().f1"></span> </h2>
          <p><span data-bind="text: lang().f6"></span></p>
	  <div class="finalizeCompanies" data-bind="foreach: $root.offerReq">
            <div class="finalizeFile">
		<div class="finalizeCompany">
		
		</div>
		<div class="finalizeCompanyReq">
		<table>
  		  <thead>
 		    <tr><th><span data-bind="text: $root.lang().b6"></th><th><span data-bind="text: $root.lang().b12"></th></tr>
  		  </thead>
  		  <tbody  data-bind="html: $root.nestedReqSkills()[$index()]">
  	 	 </tbody>
		</table>
		</div>
	    </div>
	  </div>

	  <div class = "finalizeButtons">
	    <div class = "finalizeBtn">
		<a href="#" onclick="futureModal()">
		  <div class = "finalizeIcon ">
                    <img src="images/mail.png" />
		  </div>
		  <div class = "finalizeText"><span data-bind="text: lang().f2"></span></div>
		</a>
	    </div>
	    <div class = "finalizeBtn">
		<a href="#" onclick="futureModal()">
		  <div class = "finalizeIcon ">
                    <img src="images/phone.png" />
		  </div>
		  <div class = "finalizeText"><span data-bind="text: lang().f3"></span></div>
		</a>
	    </div>
	    <div class = "finalizeBtn">
		<a href="#" onclick="futureModal()">
		  <div class = "finalizeIcon ">
                    <img src="images/meeting.png" />
		  </div>
		  <div class = "finalizeText"><span data-bind="text: lang().f4"></span></div>
		</a>
	    </div>
	    <div class = "finalizeBtn">
		<a href="#" data-bind="attr: {'href': '#/composer' + '/' + selectedOffer()}">
		  <div class = "finalizeIcon ">
                    <img src="images/reload.png" />
		  </div>
		  <div class = "finalizeText"><span data-bind="text: lang().f5"></span></div>
		</a>
	    </div>
	  </div>

        </div>	
    </div>


</div>

<!-- CONTROL -->
<div class="controlContainer">
    <div id="filterBtn" data-bind="visible: false">
    <a class="category" href="#" data-filter-by-category="true"> <span data-bind="text: lang().b2"></span> </a>
    </div>
    <div id="filterBar" data-bind="if: page() == 1">
    <input id="search" data-bind="attr: { 'placeholder': lang().b1 }, value: filter, hasfocus: focusBar, valueUpdate: 'afterkeydown'"/>
    </div>
    <div class="lines" id="Selectlines" data-bind="if: ($root.page() <= 0) && $root.viewOffers().length > 0">
        <img class="img" data-bind="attr: { 'src': $root.lang().i3 }">
    </div>
</div>
<!-- DRAGGABLES -->
<div class="dragContainer" data-bind="visible: page() < 2">
<div id="leftArrow" data-bind="visible: existPagination()">
  <a class="prevBtn" href="">
    <img id="larrow" src="images/larrow.png" />
  </a>
</div>

<div id="draggableElements">
  <div data-bind="foreach: viewOffers, visible: page() == 0, css: { content: page() == 0}">
    <div class="draggable offer clickableOffers" data-bind="click: $root.activateLoading, attr: {'name': $data.name.value}">
      <div class="draggableInfo" data-bind="click: $root.activateHelp.bind($data,'offer',$data.name.value()), clickBubble: false
	    ,attr: { 'title': '<b>'+$data.name.value()+'</b><br>' + $data.summary.value()}">?</div>
      <div class="deleteOffer" data-bind="click: $root.deleteOffer, clickBubble: false">X</div>
      <div class="logoContainer">
        <!-- ko if: $data.logo != undefined -->
        <img class="defaultLogo" src="images/default.png" data-bind="attr: {src: '.'+$data.logo.value()}"/>
        <!-- /ko -->
        <!-- ko if: $data.logo == undefined -->
        <img class="defaultLogo" src="images/default.png"/>
        <!-- /ko -->
      </div>
      <div class="textContainer">
        <p class="draggableText" data-bind="text: $data.name.value"></p>
      </div>
    </div>
    
    <!-- ko if: $index() == 13 && $parent.viewOffers().length > 14 -->
    <div class="offerButtonDIV">
      <a data-bind="attr: { 'href': './wizard/wizard.html?lang=' + $parent.lang().lang} ">
        <div id="newOfferContainer">
        <div id="newOfferText"> <span data-bind="text: $parent.lang().g1"></span> </div>
        </div>
      </a>
      <div class="lines" id="Offerlines" data-bind="if: $root.page() == 0">
        <img class="img" data-bind="attr: { 'src': $root.lang().i2 }">
      </div>
    </div>
    <!-- /ko -->
    <!-- ko if: $index() == $parent.viewOffers().length-1 && $parent.viewOffers().length < 15 -->
    <div class="offerButtonDIV">
      <a data-bind="attr: { 'href': './wizard/wizard.html?lang=' + $parent.lang().lang} ">
        <div id="newOfferContainer">
        <div id="newOfferText"> <span data-bind="text: $parent.lang().g1"></span> </div>
        </div>
      </a>
      <div class="lines" id="Offerlines" data-bind="if: $root.page() == 0">
        <img class="img" data-bind="attr: { 'src': $root.lang().i2 }">
      </div>
    </div>
    <!-- /ko -->
  </div>
  <!-- ko if: $root.viewOffers().length == 0-->
  <div class="offerButtonDIV">
      <a data-bind="attr: { 'href': './wizard/wizard.html?lang=' + $root.lang().lang} ">
        <div id="newOfferContainer">
        <div id="newOfferText"> <span data-bind="text: $root.lang().g1"></span> </div>
        </div>
      </a>
      <div class="lines" id="Offerlines" data-bind="if: $root.page() == 0">
        <img class="img" data-bind="attr: { 'src': $root.lang().i2 }">
      </div>
    </div>
  <!-- /ko -->
  <div data-bind="foreach: filteredData, beforeRemove: hideElement, visible: page() == 1, css: { content: page() == 1}">
    <div id="draggable" class="draggable draggableCompanies" data-bind="attr: { 'name': $data.name.value, 'province': $data.province.value}">
      <div class="draggableInfo" data-bind="click: $root.activateHelp.bind($data,'company',$data.id.value()), clickBubble: false
           ,attr: { 'title': '<b>'+$data.name.value()+'</b><br>' + $data.summary.value()}">?</div>
      <div class="companyMedal"></div>
      <div class="logoContainer">
        <!-- ko if: $data.logo != undefined -->
        <img class="defaultLogo" src="images/default.png" data-bind="attr: {src: $data.logo.value}"/>
        <!-- /ko -->
        <!-- ko if: $data.logo == undefined -->
        <img class="defaultLogo" src="images/default.png"/>
        <!-- /ko -->
      </div>
      <div class="textContainer">
        <p class="draggableText" data-bind="text: $data.name.value"></p>
      </div>
    </div>
  </div>

  <div class="page_navigation"></div>
  <div class="page_navigation_text" data-bind="if: page() == 1">
    <span data-bind="visible: semanticOrder() == false, text: lang().m6"></span>
    <span data-bind="visible: semanticOrder() == true, text: lang().m7"></span>
  </div>

  <div class="message" data-bind="visible: filteredData().length < 1 && filter() != '' ">
    <div class="med">
      <p>
        <span data-bind="text: lang().h1"></span>
        <b><span data-bind="text: filter"></span></b>
        <span data-bind="text: lang().h2"></span>
      </p><br>
      <p><span data-bind="text: lang().h3"></span></p><br>
      <ul>
        <li><span data-bind="text: lang().h4"></span></li>
        <li><span data-bind="text: lang().h5"></span></li>
        <li><span data-bind="text: lang().h6"></span></li>
      </ul>
    </div>
  </div>
</div>
<div id="rightArrow" data-bind="visible: existPagination()">
  <a  class="nextBtn"  href="">
    <img id="rarrowIMG" src="images/rarrow.png" />
  </a>
</div>
</div>	
<div data-bind="autoPaginate: filteredData"></div>
<!--
<pre data-bind="text: ko.toJSON(nestedReqSkills, null, 2)"></pre>
-->
</div>

<div id="footer">
            <p><span data-bind="text: lang().c1"></span></p>
		<a href="http://gsi.dit.upm.es/" target="_blank">
		<div class="gsiLogo" title="Grupo de Sistemas Inteligentes" ></div>
		</a>
		<a href="http://www.globalmetanoia.com/" target="_blank">
		<div class="globalLogo" title="Global Metanoia" ></div>
		</a>
</div>

<div id="blackDIV" data-bind="visible: help()"></div>
<div id="blackCont" data-bind="visible: help(), click: activateHelp, clickBubble: false">
  <div id="blackMSG">
    <div id="blackText">
        <div data-bind="if: $root.helpText">
          <h1 data-bind="text: lang().m5b"></h1>
          <h2>1.-<span data-bind="text: $root.lang().k1"></h2><br>
          <h2>2.-<span data-bind="text: $root.lang().k2"></h2><br>
          <h2>3.-<span data-bind="text: $root.lang().k3"></h2><br>
          <h2>4.-<span data-bind="text: $root.lang().k4"></h2><br>
        </div>
        <!--OFFER DETAILS MODAL-->
        <div data-bind="foreach: offerDetails">
          <h1><span data-bind="text: $root.lang().b20"></h1>
          <div class="logoContainer">
          <!-- ko if: $data.logo != undefined -->
          <img class="defaultLogo" src="images/default.png" data-bind="attr: {src: '.'+$data.logo.value()}"/>
          <!-- /ko -->
          <!-- ko if: $data.logo == undefined -->
          <img class="defaultLogo" src="images/default.png"/>
          <!-- /ko -->
          </div>
          <h2><span data-bind="text: $root.lang().b6"></h2>
          <p><span data-bind="text: $data.name.value"></span></p>
          <h2><span data-bind="text: $root.lang().b13"></h2>
          <p><span data-bind="text: $data.detail.value"></span></p>
          <h2><span data-bind="text: $root.lang().b14"></h2>
          <p><span data-bind="text: $data.contractor.value"></span></p>
          <h2><span data-bind="text: $root.lang().b15"></h2>
          <p><span data-bind="text: $data.budget.value"></span></p>
          <h2><span data-bind="text: $root.lang().b16"></h2>
          <p><span data-bind="text: $data.address.value"></span></p>
          <h2><span data-bind="text: $root.lang().b17"></h2>
          <p><span data-bind="text: $data.beginDate.value"></span></p>
          <h2><span data-bind="text: $root.lang().b18"></h2>
          <p><span data-bind="text: $data.endDate.value"></span></p>
          <h2><span data-bind="text: $root.lang().b19"></h2>
	</div>
        <div data-bind="foreach: offerDetails">
        <table>
  	  <thead>
 	    <tr><th><span data-bind="text: $root.lang().b6"></th><th><span data-bind="text: $root.lang().b12"></th></tr>
  	  </thead>
  	  <tbody data-bind="foreach: $root.offerDetailsSkills">
   	    <tr>
       	     <td data-bind="text: $data.field.value"></td>
             <td data-bind="text: $data.weight.value"></td>
     	    </tr>
  	  </tbody>
	</table>
        </div>
        <!--COMPANY DETAILS MODAL-->
        <div data-bind="foreach: companyDetails">
          <h1><span data-bind="text: $root.lang().b21"></h1>
          <div class="logoContainer">
          <!-- ko if: $data.logo != undefined -->
          <img class="defaultLogo" src="images/default.png" data-bind="attr: {src: $data.logo.value()}"/>
          <!-- /ko -->
          <!-- ko if: $data.logo == undefined -->
          <img class="defaultLogo" src="images/default.png"/>
          <!-- /ko -->
          </div>
          <h2><span data-bind="text: $root.lang().b6"></h2>
          <p><span data-bind="text: $data.name.value"></span></p>
          <h2><span data-bind="text: $root.lang().b7"></h2>
          <p><span data-bind="text: $data.type.value"></span></p>
          <h2><span data-bind="text: $root.lang().b8"></h2>
          <p><span data-bind="text: $data.province.value"></span></p>
          <h2><span data-bind="text: $root.lang().b9"></h2>
          <p><span data-bind="text: $data.address.value"></span></p>
          <h2><span data-bind="text: $root.lang().b10"></h2>
          <p><span data-bind="text: $data.summary.value"></span></p>
          <h2><span data-bind="text: $root.lang().b11"></h2>
	</div>
        <div data-bind="foreach: companyDetails">
	<table>
  	  <thead>
 	    <tr><th><span data-bind="text: $root.lang().b6"></th><th><span data-bind="text: $root.lang().b12"></th></tr>
  	  </thead>
  	  <tbody data-bind="foreach: $root.companyDetailsSkills">
   	    <tr>
       	     <td data-bind="text: $data.skillname.value"></td>
             <td data-bind="text: $data.skilllevel.value"></td>
     	    </tr>
  	  </tbody>
	</table>
        </div>
    </div>
  </div>
</div>

<!--CONFIRM MODAL-->
<div id="confirmOverlay">
    <div id="confirmBox">

        <h1>Title of the confirm dialog</h1>
        <p>Description of what is about to happen</p>

        <div id="confirmButtons">
            <a class="button blue" href="#">Yes<span></span></a>
            <a class="button gray" href="#">No<span></span></a>
        </div>
    </div>
</div>
</body>

</html>





